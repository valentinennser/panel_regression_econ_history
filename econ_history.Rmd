---
title: "econ_history"
output: html_document
date: "2025-11-19"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

data source 
https://infothek.ekir.de/pages/search.php?search=!collection73&collection=73&k=#

```{r data}
# DATA LOADING

religion_de_2023 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg", "Bayern", "Berlin", "Brandenburg",
    "Bremen", "Hamburg", "Hessen", "Mecklenburg-Vorpommern",
    "Niedersachsen", "Nordrhein-Westfalen", "Rheinland-Pfalz", "Saarland",
    "Sachsen", "Sachsen-Anhalt", "Schleswig-Holstein", "Thüringen",
    "Deutschland insgesamt", "Westliche Bundesländer", "Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    11339300, 13435100, 3782200, 2581700,
    691700, 1910200, 6420700, 1629500,
    8162000, 18190400, 4174300, 994400,
    4089500, 2180400, 2965700, 2122300,
    84669300, 68283700, 16385600
  ),
  
  Ev_Anzahl = c(
    2776500, 2092300, 468700, 323900,
    186200, 383700, 1817100, 206600,
    3033000, 3779200, 981600, 152000,
    639200, 224900, 1118400, 382900,
    18566600, 16391900, 2246700
  ),
  
  Ev_Prozent = c(
    24.5, 15.6, 12.4, 12.5,
    26.9, 20.1, 28.3, 12.7,
    37.2, 20.8, 23.5, 15.3,
    15.6, 10.3, 37.7, 18.0,
    21.9, 23.9, 13.7
  ),
  
  Kat_Anzahl = c(
    3219300, 5675100, 275400, 88500,
    59200, 157300, 1202400, 51200,
    1214500, 5954000, 1446600, 487200,
    141900, 65100, 157500, 150600,
    20345900, 19573200, 772700
  ),
  
  Kat_Prozent = c(
    28.4, 42.2, 7.3, 3.4,
    8.6, 8.2, 18.7, 3.1,
    14.9, 32.7, 34.7, 49.0,
    3.5, 3.0, 5.3, 7.1,
    24.0, 28.7, 4.7
  ),
  
  Andere_Anzahl = c(
    5343400, 5667600, 3038100, 2169200,
    446400, 1369100, 3401300, 1371700,
    3914500, 8457100, 1746100, 355200,
    3308500, 1898400, 1689800, 1588800,
    45757400, 32390600, 13366800
  ),
  
  Andere_Prozent = c(
    47.1, 42.2, 80.3, 84.0,
    64.5, 71.7, 53.0, 84.2,
    48.0, 46.5, 41.8, 35.7,
    80.9, 86.7, 57.0, 74.9,
    54.0, 47.4, 81.6
  )
)

religion_de_2022 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg", "Bayern", "Berlin", "Brandenburg",
    "Bremen", "Hamburg", "Hessen", "Mecklenburg-Vorpommern",
    "Niedersachsen", "Nordrhein-Westfalen", "Rheinland-Pfalz", "Saarland",
    "Sachsen", "Sachsen-Anhalt", "Schleswig-Holstein", "Thüringen",
    "Deutschland insgesamt", "Westliche Bundesländer", "Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    11280300, 13369400, 3755300, 2573100,
    684900, 1892100, 6391400, 1628400,
    8142000, 18139000, 4159200, 992700,
    4086200, 2186600, 2953300, 2126800,
    84358800, 68002400, 16356400
  ),
  
  Ev_Anzahl = c(
    2857500, 2151300, 486900, 334900,
    194200, 403600, 1874400, 213600,
    3124900, 3900500, 1008900, 156700,
    659800, 232700, 1155900, 397000,
    19152800, 16827900, 2324900
  ),
  
  Ev_Prozent = c(
    25.1, 16.1, 13.0, 13.0,
    28.4, 21.3, 29.3, 13.1,
    38.4, 21.5, 24.3, 15.8,
    16.1, 10.6, 39.1, 18.6,
    22.7, 24.7, 14.2
  ),
  
  Kat_Anzahl = c(
    3315500, 5818100, 281400, 93000,
    60900, 163800, 1244100, 52500,
    1244500, 6139900, 1491100, 504500,
    144800, 66800, 162900, 153800,
    20937600, 20145200, 792400
  ),
  
  Kat_Prozent = c(
    29.4, 43.5, 7.5, 3.6,
    8.9, 8.7, 19.5, 3.2,
    15.3, 33.8, 35.9, 50.8,
    3.5, 3.1, 5.5, 7.2,
    24.8, 29.6, 4.8
  ),
  
  Andere_Anzahl = c(
    5107300, 5400000, 2986900, 2145200,
    429800, 1324700, 3272800, 1362200,
    3770900, 8098800, 1659100, 331400,
    3281600, 1887100, 1634500, 1576000,
    44268400, 31029300, 13239100
  ),
  
  Andere_Prozent = c(
    45.3, 40.4, 79.6, 83.4,
    62.8, 70.0, 51.2, 83.7,
    46.3, 44.6, 39.9, 33.4,
    80.3, 86.3, 55.3, 74.1,
    52.5, 45.6, 80.9
  )
)

religion_de_2021 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    11124600,13177000,3677500,2537900,
    676500,1853900,6295000,1611200,
    8027000,17924600,4106500,982300,
    4043200,2169300,2922000,2108900,
    83237100,67089500,16147600
  ),
  
  Ev_Anzahl = c(
    2934900,2209700,506700,343700,
    201400,422600,1931500,221000,
    3213600,4015800,1036800,161200,
    678200,241400,1195400,410900,
    19725300,17323400,2401900
  ),
  
  Ev_Prozent = c(
    26.4,16.8,13.8,13.5,
    29.8,22.8,30.7,13.7,
    40.0,22.4,25.2,16.4,
    16.8,11.1,40.9,19.5,
    23.7,25.8,14.9
  ),
  
  Kat_Anzahl = c(
    3425800,6021400,293100,93200,
    62900,170600,1293400,54000,
    1277400,6344800,1543900,523100,
    148100,69100,167800,157200,
    21645900,20831200,814700
  ),
  
  Kat_Prozent = c(
    30.8,45.7,8.0,3.7,
    9.3,9.2,20.5,3.4,
    15.9,35.4,37.6,53.2,
    3.7,3.2,5.7,7.5,
    26.0,31.0,5.0
  ),
  
  Andere_Anzahl = c(
    4763900,4945800,2877600,2101000,
    412100,1260700,3070000,1336100,
    3536000,7564000,1525800,298100,
    3216700,1858700,1558300,1540800,
    41865900,28593000,12931000
  ),
  
  Andere_Prozent = c(
    42.8,37.5,78.3,82.8,
    60.9,68.0,48.8,82.9,
    44.1,42.2,37.2,30.3,
    79.6,85.7,53.3,73.1,
    50.3,43.1,80.1
  )
)

religion_de_2020 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    11103000,13140200,3664100,2531100,
    680100,1852500,6293200,1610800,
    8003400,17925600,4098400,984000,
    4056900,2180700,2910900,2120200,
    83155200,66991200,16163800
  ),
  
  Ev_Anzahl = c(
    2998500,2260600,525500,352600,
    209500,437600,1986000,228400,
    3291900,4118900,1062200,165300,
    698200,249300,1227000,424600,
    20236200,17757500,2478700
  ),
  
  Ev_Prozent = c(
    27.0,17.2,14.3,13.9,
    30.8,23.6,31.6,14.2,
    41.1,23.0,25.9,16.8,
    17.2,11.4,42.2,20.0,
    24.3,26.5,15.3
  ),
  
  Kat_Anzahl = c(
    3515800,6162600,306500,90800,
    64900,174800,1333500,54600,
    1302200,6514200,1584400,536800,
    150400,70600,171700,159700,
    22193300,21360900,832500
  ),
  
  Kat_Prozent = c(
    31.7,46.9,8.4,3.6,
    9.5,9.4,21.2,3.4,
    16.3,36.3,38.7,54.6,
    3.7,3.2,5.9,7.5,
    26.7,31.9,5.2
  ),
  
  Andere_Anzahl = c(
    4588800,4716900,2832100,2087600,
    405800,1240100,2973700,1327800,
    3409300,7292500,1451700,281800,
    3208400,1860800,1512200,1536000,
    40725500,27872800,12852000
  ),
  
  Andere_Prozent = c(
    41.3,35.9,77.3,82.5,
    59.7,66.9,47.3,82.4,
    42.6,40.7,35.4,28.6,
    79.1,85.3,52.0,72.4,
    49.0,41.6,79.5
  )
)

religion_de_2019 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    11100400,13124400,3669500,2521900,
    681200,1847300,6288100,1608100,
    7993600,17947200,4093900,986900,
    4072000,2194800,2903800,2133400,
    83166700,66967100,16199700
  ),
  
  Ev_Anzahl = c(
    3073800,2306100,541300,360100,
    214600,450000,2042000,232500,
    3366900,4211300,1078300,169400,
    715900,257000,1257400,436500,
    20713200,18169800,2543400
  ),
  
  Ev_Prozent = c(
    27.7,17.6,14.8,14.3,
    31.5,24.4,32.5,14.5,
    42.1,23.5,26.3,17.2,
    17.6,11.7,43.3,20.5,
    24.9,27.1,15.7
  ),
  
  Kat_Anzahl = c(
    3583400,6276600,312600,90200,
    67300,177600,1362800,54500,
    1321000,6633100,1614300,549200,
    151200,72000,173300,161400,
    22600400,21758500,841800
  ),
  
  Kat_Prozent = c(
    32.3,47.6,8.5,3.6,
    9.9,9.6,21.7,3.4,
    16.5,37.0,39.4,55.7,
    3.7,3.3,6.0,7.6,
    27.2,32.5,5.2
  ),
  
  Andere_Anzahl = c(
    4443100,4522000,2815500,2071600,
    399300,1219600,2883300,1321200,
    3305700,7102800,1401300,268300,
    3204900,1865800,1473300,1535400,
    39853100,27037800,12814400
  ),
  
  Andere_Prozent = c(
    40.0,34.6,76.7,82.1,
    58.6,66.0,45.9,82.2,
    41.4,39.6,34.2,27.2,
    78.7,85.0,50.7,72.0,
    47.9,40.4,79.1
  )
)

religion_de_2018 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    11069500,13076700,3644800,2511900,
    683000,1841200,6265500,1609700,
    7982400,17932700,4084800,990500,
    4077900,2208300,2896700,2143300,
    83019200,66823400,16515800
  ),
  
  Ev_Anzahl = c(
    3131600,2335400,559400,367600,
    223400,457900,2091000,237900,
    3433800,4302200,1094700,173000,
    730800,263500,1293000,445500,
    21140600,18535900,2604700
  ),
  
  Ev_Prozent = c(
    28.3,17.9,15.3,14.6,
    32.7,24.9,33.4,14.8,
    43.0,24.0,26.8,17.5,
    17.9,11.9,44.6,20.8,
    25.5,27.7,16.1
  ),
  
  Kat_Anzahl = c(
    3646500,6377700,320900,90200,
    68900,182500,1394200,55200,
    1342200,6751200,1645700,562600,
    152300,73700,175700,163600,
    23002000,22146200,855900
  ),
  
  Kat_Prozent = c(
    32.9,48.8,8.8,3.6,
    10.1,9.9,22.3,3.4,
    16.8,37.7,40.3,56.8,
    3.7,3.3,6.1,7.6,
    27.7,33.1,5.3
  ),
  
  Andere_Anzahl = c(
    4293300,4363600,2764500,2054100,
    390700,1200900,2786000,1316600,
    3206500,6878800,1344400,254900,
    3194800,1871100,1427800,1534400,
    38876500,26141300,12735200
  ),
  
  Andere_Prozent = c(
    38.8,33.4,75.8,81.8,
    57.2,65.2,44.4,81.8,
    40.2,38.4,32.9,25.7,
    78.3,84.7,49.3,71.6,
    46.8,39.1,78.6
  )
)

religion_de_2017 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    11023400,12997200,3613500,2504000,
    681000,1830600,6243300,1611100,
    7962800,17912100,4073700,994200,
    4081300,2223100,2889800,2151200,
    82792400,66608000,16184200
  ),
  
  Ev_Anzahl = c(
    3179900,2378800,574600,374700,
    228400,467500,2121400,244000,
    3497100,4378500,1122800,176400,
    744700,271700,1316200,459400,
    21535900,18866800,2669000
  ),
  
  Ev_Prozent = c(
    28.8,18.3,15.9,15.0,
    33.5,25.5,34.0,15.1,
    43.9,24.4,27.6,17.7,
    18.2,12.2,45.5,21.4,
    26.0,28.3,16.5
  ),
  
  Kat_Anzahl = c(
    3688400,6447200,330600,84300,
    75900,194000,1423200,54800,
    1348400,6858500,1671200,572800,
    152300,75900,168500,165700,
    23311300,22447900,863400
  ),
  
  Kat_Prozent = c(
    33.5,49.6,9.2,3.4,
    11.1,10.6,22.8,3.4,
    16.9,38.3,41.0,57.6,
    3.7,3.4,5.8,7.7,
    28.2,33.7,5.3
  ),
  
  Andere_Anzahl = c(
    4155200,4171200,2708200,2045000,
    376800,1169000,2698700,1312300,
    3117400,6675100,1279700,245000,
    3184600,1875500,1405100,1526100,
    37945200,25293400,12651800
  ),
  
  Andere_Prozent = c(
    37.7,32.1,74.9,81.7,
    55.3,63.9,43.2,81.5,
    39.1,37.3,31.4,24.6,
    78.0,84.2,48.6,70.9,
    45.8,38.0,78.2
  )
)

religion_de_2015 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    10879600,12843500,3520000,2484800,
    671500,1787400,6176200,1612400,
    7926600,17865500,4052800,995600,
    4084900,2245500,2858700,2170700,
    82175700,66057400,16118300
  ),
  
  Ev_Anzahl = c(
    3272000,2438900,597700,390200,
    242100,482600,2200000,254400,
    3621500,4529400,1156200,183000,
    771300,285300,1365900,481300,
    22271900,19491700,2780200
  ),
  
  Ev_Prozent = c(
    30.1,19.0,17.0,15.7,
    36.1,27.0,35.6,15.8,
    45.7,25.4,28.5,18.4,
    18.9,12.7,47.8,22.2,
    27.1,29.5,17.2
  ),
  
  Kat_Anzahl = c(
    3756600,6571300,330200,81800,
    77200,192000,1446100,54800,
    1365700,7012800,1711500,595400,
    150600,77600,169700,168600,
    23761800,22898200,863700
  ),
  
  Kat_Prozent = c(
    34.5,51.2,9.4,3.3,
    11.5,10.7,23.4,3.4,
    17.2,39.3,42.2,59.8,
    3.7,3.5,5.9,7.8,
    28.9,34.7,5.4
  ),
  
  Andere_Anzahl = c(
    3851000,3833400,2592100,2012900,
    352200,1112800,2530100,1303000,
    2939400,6323300,1185100,217200,
    3162900,1872400,1323100,1528000,
    36142000,23667600,12474400
  ),
  
  Andere_Prozent = c(
    35.4,29.8,73.6,81.0,
    52.5,62.3,41.0,80.8,
    37.1,35.4,29.2,21.8,
    77.4,83.8,46.3,70.1,
    44.0,35.8,77.4
  )
)

religion_de_2014 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    10716600,12691600,3469800,2457900,
    661900,1762800,6093900,1599100,
    7826700,17638100,4011600,989000,
    4055300,2235500,2830900,2156800,
    81197500,65223100,15974400
  ),
  
  Ev_Anzahl = c(
    3324300,2464600,611800,396400,
    247600,492100,2236400,260100,
    3674400,4596800,1171500,185700,
    786800,293900,1393600,493400,
    22629300,19786900,2842400
  ),
  
  Ev_Prozent = c(
    31.0,19.4,17.6,16.1,
    37.4,27.9,36.7,16.3,
    46.9,26.1,29.2,18.8,
    19.4,13.1,49.2,22.9,
    27.9,30.3,17.8
  ),
  
  Kat_Anzahl = c(
    3779500,6612100,331400,80300,
    79000,191200,1452100,54500,
    1365200,7095700,1727600,605000,
    149800,78600,168400,169100,
    23939500,23075700,863700
  ),
  
  Kat_Prozent = c(
    35.3,52.1,9.6,3.3,
    11.9,10.8,23.8,3.4,
    17.4,40.2,43.1,61.2,
    3.7,3.5,5.9,7.8,
    29.5,35.4,5.4
  ),
  
  Andere_Anzahl = c(
    3612800,3614900,2526600,1981100,
    335300,1079500,2405400,1284600,
    2787200,5945500,1115200,198300,
    3118700,1863400,1268900,1494300,
    34628800,22360500,12268300
  ),
  
  Andere_Prozent = c(
    33.7,28.5,72.8,80.6,
    50.7,61.2,39.5,80.3,
    35.6,33.7,27.7,20.1,
    76.9,83.3,44.8,69.3,
    42.6,34.3,76.8
  )
)

religion_de_2012 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),
  
  Bevölkerung = c(
    10569100,12519600,3375200,2449500,
    654800,1734300,6016500,1600300,
    7779000,17554300,3990300,994300,
    4050200,2259400,2806500,2170500,
    80523700,64618600,15905100
  ),
  
  Ev_Anzahl = c(
    3412800,2519900,633300,413400,
    256300,516400,2311800,273200,
    3792400,4742300,1205300,191600,
    818300,314000,1440900,514100,
    23356100,20389800,2966300
  ),
  
  Ev_Prozent = c(
    32.3,20.1,18.8,16.9,
    39.1,29.8,38.4,17.1,
    48.8,27.0,30.2,19.3,
    20.2,13.9,51.3,23.7,
    29.0,31.6,18.7
  ),
  
  Kat_Anzahl = c(
    3836500,6726100,326500,78700,
    79100,185800,1471900,53800,
    1374200,7246300,1765600,623600,
    149100,80000,171400,171400,
    24340000,23480600,859500
  ),
  
  Kat_Prozent = c(
    36.3,53.7,9.7,3.2,
    12.1,10.7,24.5,3.4,
    17.7,41.3,44.2,62.7,
    3.7,3.5,6.1,7.9,
    30.2,36.3,5.4
  ),
  
  Andere_Anzahl = c(
    3319700,3273600,2415400,1957400,
    319400,1032100,2232800,1273300,
    2612400,5565800,1019400,179000,
    3082800,1865400,1194200,1484900,
    32827600,20748300,12079300
  ),
  
  Andere_Prozent = c(
    31.4,26.1,71.6,79.9,
    48.8,59.5,37.1,79.6,
    33.6,31.7,25.5,18.0,
    76.1,82.6,42.5,68.4,
    40.8,32.1,75.9
  )
)

religion_de_2011 <- data.frame(
  Bundesland = c(
    "Baden-Württemberg","Bayern","Berlin","Brandenburg",
    "Bremen","Hamburg","Hessen","Mecklenburg-Vorpommern",
    "Niedersachsen","Nordrhein-Westfalen","Rheinland-Pfalz","Saarland",
    "Sachsen","Sachsen-Anhalt","Schleswig-Holstein","Thüringen",
    "Deutschland insgesamt","Westliche Bundesländer","Östliche Bundesländer"
  ),

  Bevölkerung = c(
    10786200,12595900,3501900,2495600,
    661300,1798800,6092100,1634700,
    7913500,17842000,3999100,1013400,
    4137100,2313300,2837600,2221200,
    81843700,65539900,16303800
  ),

  Ev_Anzahl = c(
    3443700,2540600,641300,420100,
    262500,515900,2337400,278600,
    2834500,4800300,1218100,193900,
    828900,322000,1458700,523400,
    22619600,19605500,3014200
  ),

  Ev_Prozent = c(
    31.9,20.2,18.3,16.8,
    39.7,28.7,38.4,17.0,
    35.8,26.9,30.5,19.1,
    20.0,13.9,51.4,23.6,
    27.6,29.9,18.5
  ),

  Kat_Anzahl = c(
    3858000,6760600,322200,77900,
    81000,183100,1478300,53700,
    1372800,7302800,1779800,631800,
    148300,80600,169800,172300,
    24472800,23617800,855000
  ),

  Kat_Prozent = c(
    35.8,53.7,9.2,3.1,
    12.2,10.2,24.3,3.3,
    17.3,40.9,44.5,62.3,
    3.6,3.5,6.0,7.8,
    29.9,36.0,5.2
  ),

  Andere_Anzahl = c(
    3484600,3294600,2538300,1997700,
    317800,1099900,2276400,1302400,
    3706300,5738900,1001200,187700,
    3159900,1910700,1209100,1525500,
    34751300,22316600,12434600
  ),

  Andere_Prozent = c(
    32.3,26.2,72.5,80.0,
    48.1,61.1,37.4,79.7,
    46.8,32.2,25.0,18.5,
    76.4,82.6,42.6,68.7,
    42.5,34.1,76.3
  )
)

gnp_de <- readxl::read_excel("82111-0010_de.xlsx")


# DATA TRANSFORMATION
religion_de_2011$Jahr <- 2012
religion_de_2012$Jahr <- 2013
religion_de_2014$Jahr <- 2014
religion_de_2015$Jahr <- 2015
religion_de_2017$Jahr <- 2017
religion_de_2018$Jahr <- 2018
religion_de_2019$Jahr <- 2019
religion_de_2020$Jahr <- 2020
religion_de_2021$Jahr <- 2021
religion_de_2022$Jahr <- 2022
religion_de_2023$Jahr <- 2023

library(dplyr)
library(tidyr)

religion_data <- bind_rows(
  religion_de_2011, religion_de_2012, religion_de_2014, religion_de_2015, religion_de_2017,
  religion_de_2018, religion_de_2019, religion_de_2020, religion_de_2021, religion_de_2022,
  religion_de_2023
)

religion_data <- religion_data %>%
  mutate(
    'Bevölkerung' = rowSums(across(c(Ev_Anzahl, Kat_Anzahl, Andere_Anzahl))),
  )

gnp_raw <- gnp_de [-c(1:3),]
gnp_raw[1, 1] <- 'Jahr'

colnames(gnp_raw) <- as.character(as.vector(gnp_raw[1, ]))
gnp_raw <- gnp_raw[-1, ]
gnp_cleaned <- drop_na(gnp_raw)

gnp_cleaned <- gnp_cleaned %>%
  select(where(~ !any(grepl("e", .x, ignore.case = TRUE))))

gnp_cleaned <- gnp_cleaned %>% 
  # make all state columns numeric
  mutate(across(
    c(`Baden-Württemberg`, Bayern, Berlin, Brandenburg, Bremen, Hamburg,
      Hessen, `Mecklenburg-Vorpommern`, Niedersachsen, `Nordrhein-Westfalen`,
      `Rheinland-Pfalz`, Saarland, Sachsen, `Sachsen-Anhalt`,
      `Schleswig-Holstein`, Thüringen),
    as.numeric
  )) %>%
  # add West / East totals
  mutate(
    `Westliche Bundesländer` = rowSums(across(c(
      `Baden-Württemberg`, Bayern, Bremen, Hamburg, Hessen,
      Niedersachsen, `Nordrhein-Westfalen`, `Rheinland-Pfalz`,
      Saarland, `Schleswig-Holstein`
    )), na.rm = TRUE),
    
    `Östliche Bundesländer` = rowSums(across(c(
      Brandenburg, `Mecklenburg-Vorpommern`,
      Sachsen, `Sachsen-Anhalt`, Thüringen
    )), na.rm = TRUE)
  )

gnp_long <- gnp_cleaned %>%
  pivot_longer(
    cols = -Jahr,
    names_to = "Bundesland",
    values_to = "gnp"
  )

religion_data$Jahr <- as.numeric(religion_data$Jahr)
gnp_long$Jahr <- as.numeric(gnp_long$Jahr)

df_final <- religion_data %>%
  left_join(gnp_long, by = c("Bundesland", "Jahr")) %>%
  drop_na()

df_final <- df_final %>%
  mutate(
    'gnp_per_capita' = gnp * 1000000 / Bevölkerung
  )
df_final$gnp_per_capita <- as.numeric(df_final$gnp_per_capita)

df_final <- df_final %>%
  filter(!(Bundesland %in% c("Westliche Bundesländer", "Östliche Bundesländer")))

df_final <- df_final %>%
  arrange(Bundesland, Jahr) %>%
  group_by(Bundesland) %>%
  mutate(
    Ev_Prozent_lag  = lag(Ev_Prozent, 1),
    Kat_Prozent_lag = lag(Kat_Prozent, 1),
    gnp_growth = log(gnp_per_capita) - log(lag(gnp_per_capita))
  ) %>%
  ungroup()

df_final <- df_final %>% drop_na(Ev_Prozent_lag, Kat_Prozent_lag)


# PANEL REGRESSION (FIXED EFFECTS)

library(plm)


model_lagged <- plm(
  log(gnp_per_capita) ~ Ev_Prozent_lag + Kat_Prozent_lag + factor(Jahr),
  data = df_final,
  index = c("Bundesland", "Jahr"),
  model = "within"     
)
summary(model_lagged)



model_ab <- plm(
  log(gnp_per_capita) ~ lag(log(gnp_per_capita), 1) + Ev_Prozent_lag + Kat_Prozent_lag,
  data = df_final,
  model = "random",
  index = c("Bundesland", "Jahr"),
  effect = "twoways"
)

summary(model_ab)
```
